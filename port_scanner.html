<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>localhost Port scanning test</title>
  </head>
  <body>
<h2>Port scanning test</h2>
<button id="start">Start test</button><br>
<div id="log">
</div>
<script>
  var log = function(m,ok){
    var e = document.createElement("span")
    e.innerText = m
    if(ok === true){
      e.style.color = "green"
    }
    else{
      e.style.color = "red"
    }
    document.getElementById("log").appendChild(e)
    document.getElementById("log").appendChild(document.createElement("br"))
  }
  
  var test = async function(port){
    try{
      await fetch("http://localhost:" + port,{mode:"no-cors"})
      window.detectedon.push(port)
      console.log("Detected on port " + port, false)
    }
    catch(err){
      console.log("Not detected on port " + port,true)
    }
    window.total.push(port)
    if(window.total.length == 90){
      var t=0
      for(t=0;t < window.total.length;t++){
        if(window.detectedon.includes(window.total[t])){
          log("Detected on " + window.total[t],true)
        }
        else{
          log("Not detected on " + window.total[t],false)
        }
      }
    }
  }
  
  document.getElementById("start").onclick = async function(){
    window.detectedon = []
    window.total = []
    window.p = 0;
    for(window.p = 0; window.p < 90; window.p ++){
      console.log(p,window.p)
      try{
        test(p)
      }
      catch(err){
        console.log("Can not reach " + window.p,true)
      }
  
    }
  }
</script>
  </body>
</html>
